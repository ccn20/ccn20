<!DOCTYPE html>
<html>
  <head>
    <title>InAppBrowser.addEventListener Example</title>

    <script type="text/javascript" src="cordova.js"></script>
    <script>

	document.addEventListener("deviceready", onDeviceReady, false);

    // device APIs are available
    //
    function onDeviceReady() {
	
        var ref = window.open('https://foursquare.com/oauth2/authenticate?client_id=4P4XY5XMV2EEGL4THQFXJFMJBTJN4WBNX1VIQGAUWDPHYZZF&response_type=token&redirect_uri=http://www.wificomo.com/ccn20/closeFoursquare.html', '_blank', 'location=yes');
		
		ref.addEventListener('loadstart', function(event) {
        closeFoursquare(event.url,ref);
		});  
    
	}
	
function closeFoursquare(loc,ref) {
   
   if (loc.indexOf("www.wificomo.com/ccn20/closeFoursquare.html#") > -1){
   alert(loc);
   var token = loc.substring(loc.indexOf("=")+1);
   alert(token);
   ref.close();
   }
}

    </script>
  </head>
  <body>
  </body>
</html>